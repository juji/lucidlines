

# Only run on main branch
current_branch=$(git branch --show-current)
if [ "$current_branch" != "main" ]; then
  exit 0
fi

# Get the list of changed files in the last commit
changed_files=$(git diff-tree --no-commit-id --name-only -r HEAD)

# Check if doc directory was changed
if echo "$changed_files" | grep -q "^doc/"; then
  echo "ðŸ“š Doc changes detected, updating doc branch..."
  git checkout doc
  git merge main
  git push origin doc
  git checkout main
  echo "âœ… Doc branch updated"
fi

# Check if src directory or package.json was changed
if echo "$changed_files" | grep -qE "^src/|^package\.json$"; then
  echo "ðŸš€ Source changes detected, updating release branch..."
  git checkout release
  git merge main
  git push origin release
  git checkout main
  echo "âœ… Release branch updated"
fi
